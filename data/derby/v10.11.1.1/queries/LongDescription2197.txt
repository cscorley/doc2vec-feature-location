Some of the code for locking a row while holding a latch doesn't seem to be used outside the unit tests for store. This code should be removed in order to reduce the overall complexity. See the discussion in DERBY-2107 for details.