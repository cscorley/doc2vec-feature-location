Factor out type checks in EmbedResultSet and EmbedPreparedStatement