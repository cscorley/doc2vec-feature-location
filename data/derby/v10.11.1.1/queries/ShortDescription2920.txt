Share code between readExternal() and readExternalFromArray()